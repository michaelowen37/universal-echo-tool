<!DOCTYPE html>
<html>
<head>
  <title>Left Ventricle – Segments</title>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <link rel="stylesheet" type="text/css" href="./style3.css">
  <link rel="icon" type="image/png" href="BSW_Thumbnail.png" />

  <!-- Page-specific layout (kept from your version) -->
  <style>
    /* Same look/feel as perfusion page */
    #segments-app { max-width: 1100px; margin: 0 auto; padding: 4px 0 12px; }

    /* 1×4 on small screens, 2×2 on desktop, fixed order */
    .segments-grid { display: grid; grid-template-columns: 1fr; gap: 12px; }
    @media (min-width: 760px){
      .segments-grid {
        grid-template-columns: repeat(2, 1fr);
        grid-template-areas: "ap4c ap2c" "ap3c psax";
      }
      .card[data-key="ap4c"]{ grid-area: ap4c }
      .card[data-key="ap2c"]{ grid-area: ap2c }
      .card[data-key="ap3c"]{ grid-area: ap3c }
      .card[data-key="psax"]{ grid-area: psax }
    }

    /* Soft cards */
    .card { border-radius: 18px; overflow: hidden; border: 1px solid rgba(255,255,255,.1); background: #0b0f16; box-shadow: 0 8px 28px rgba(0,0,0,.28); }
    .card-media { background: #0b0f16; }

    /* Uniform squares; image contained with soft edges */
    .imgwrap { position: relative; width: 100%; aspect-ratio: 1 / 1; overflow: hidden; border-radius: 16px; background: #0b0f16; }
    .imgwrap img { position: absolute; inset: 0; width: 100%; height: 100%; object-fit: contain; display: block; border-radius: 16px; }

    /* Lightbox */
    .modal { position: fixed; inset: 0; background: rgba(6,10,16,.85); backdrop-filter: saturate(120%) blur(4px); display: none; align-items: center; justify-content: center; z-index: 999; }
    .modal.open { display: flex; }
    .lightbox { width: min(96vw, 1200px); max-height: 92vh; background: rgba(0,0,0,.45); border: 1px solid rgba(255,255,255,.12); border-radius: 14px; overflow: hidden; }
    .lightbox-head { display: flex; align-items: center; justify-content: space-between; gap: 8px; padding: 8px 10px; border-bottom: 1px solid rgba(255,255,255,.08); }
    .lightbox-tools { display: flex; gap: 6px; }
    .tool { cursor: pointer; border-radius: 10px; padding: 6px 10px; border: 1px solid rgba(255,255,255,.12); background: rgba(0,0,0,.25); color: inherit; }
    .lightbox-body { background: #0b0f16; display: flex; align-items: center; justify-content: center; }
    .stage { max-height: calc(92vh - 46px); overflow: auto; }
    .stage img { display: block; max-width: none; transform-origin: center center; user-select: none; pointer-events: none; border-radius: 16px; background: #0b0f16; }
  </style>
</head>
<body>
  <nav class="zone nav-bar">
    <ul class="main-nav">
      <li><a class="top-nav" href="index.html">Home</a></li>
      <li class="push"><a class="top-nav" href="lwh_echo.html">Back</a></li>
    </ul>

    <!-- Preferred tight title/subtitle stack -->
    <div class="title-stack">
      <div class="container zone body dg-title">Left Ventricle:</div>
      <!-- <div class="container normal-note dg-subtitle" style="padding:0"><em>Segments</em></div> -->
    </div>

    <br>

    <!-- Preferred chips: sharp, touching, responsive -->
    <div class="navbar">
      <a class="nospace" href="#"></a>
      <a class="active border" href="lv_segments.html">Segments</a>
      <a class="border" href="lv_perfusion.html">Perfusion</a>
      <a class="nospace" href="#"></a>
    </div>
  </nav>

  <div class="zone navigation">
    <div class="final">
      <section id="segments-app">
        <div class="segments-grid" id="segments-grid">
          <!-- 1. AP4C -->
          <figure class="card" data-key="ap4c">
            <div class="card-media">
              <div class="imgwrap">
                <img data-label="AP4C" data-src="ap4c_segments.svg" alt="AP4C segments" />
              </div>
            </div>
          </figure>

          <!-- 2. AP2C -->
          <figure class="card" data-key="ap2c">
            <div class="card-media">
              <div class="imgwrap">
                <img data-label="AP2C" data-src="ap2c_segments.svg" alt="AP2C segments" />
              </div>
            </div>
          </figure>

          <!-- 3. AP3C -->
          <figure class="card" data-key="ap3c">
            <div class="card-media">
              <div class="imgwrap">
                <img data-label="AP3C" data-src="ap3c_segments.svg" alt="AP3C segments" />
              </div>
            </div>
          </figure>

          <!-- 4. PSAX -->
          <figure class="card" data-key="psax">
            <div class="card-media">
              <div class="imgwrap">
                <img data-label="PSAX" data-src="psax_segments.svg" alt="PSAX segments" />
              </div>
            </div>
          </figure>
        </div>
      </section>

      <!-- Lightbox modal -->
      <div class="modal" id="lv-modal" role="dialog" aria-modal="true" aria-labelledby="lv-lb-title">
        <div class="lightbox">
          <div class="lightbox-head">
            <div id="lv-lb-title" class="lightbox-title">Viewer</div>
            <div class="lightbox-tools">
              <button class="tool" id="lv-zoom-in">+</button>
              <button class="tool" id="lv-zoom-out">−</button>
              <button class="tool" id="lv-reset">Reset</button>
              <button class="tool" id="lv-prev">←</button>
              <button class="tool" id="lv-next">→</button>
              <button class="tool" id="lv-close">✕</button>
            </div>
          </div>
          <div class="lightbox-body"><div class="stage" id="lv-stage"></div></div>
        </div>
      </div>

      <script>
        (function(){
          // Lazy-load
          const imgs = Array.from(document.querySelectorAll('#segments-app img[data-src]'));
          const io = new IntersectionObserver((entries, obs)=>{
            entries.forEach(e=>{
              if(e.isIntersecting){
                const el=e.target; el.src=el.dataset.src; obs.unobserve(el);
              }
            });
          }, {rootMargin:'200px'});
          imgs.forEach(i=>io.observe(i));

          // Lightbox viewer
          const modal = document.getElementById('lv-modal');
          const stage = document.getElementById('lv-stage');
          const title = document.getElementById('lv-lb-title');
          const order = ['AP4C','AP2C','AP3C','PSAX'];
          let idx = 0; let zoom = 1;

          function openLightbox(startIdx){
            idx = startIdx; zoom = 1; stage.innerHTML = '';
            const src = document.querySelector(`#segments-app img[data-label="${order[idx]}"]`).src;
            const img = new Image(); img.src = src; img.alt = order[idx] + ' full view';
            img.style.transform = `scale(${zoom})`;
            img.style.borderRadius = '16px';
            img.style.background = '#0b0f16';
            stage.appendChild(img);
            title.textContent = `Viewer — ${order[idx]}`;
            modal.classList.add('open');
          }
          function closeLightbox(){ modal.classList.remove('open'); }
          function navigate(delta){ idx = (idx + delta + order.length) % order.length; openLightbox(idx); }
          function setZoom(next){ zoom = Math.max(.2, Math.min(6, next)); const img = stage.querySelector('img'); if(img){ img.style.transform = `scale(${zoom})`; } }

          document.getElementById('lv-zoom-in').onclick = ()=> setZoom(zoom+0.2);
          document.getElementById('lv-zoom-out').onclick = ()=> setZoom(zoom-0.2);
          document.getElementById('lv-reset').onclick = ()=> setZoom(1);
          document.getElementById('lv-prev').onclick = ()=> navigate(-1);
          document.getElementById('lv-next').onclick = ()=> navigate(1);
          document.getElementById('lv-close').onclick = closeLightbox;

          document.addEventListener('keydown',(e)=>{
            if(!modal.classList.contains('open')) return;
            if(e.key==='Escape') closeLightbox();
            else if(e.key==='ArrowLeft') navigate(-1);
            else if(e.key==='ArrowRight') navigate(1);
            else if(e.key==='+') setZoom(zoom+0.2);
            else if(e.key==='-'||e.key==='–') setZoom(zoom-0.2);
            else if(e.key==='0') setZoom(1);
          });

          // Click to open
          document.querySelectorAll('#segments-app .imgwrap img').forEach((im, i)=>{
            im.addEventListener('click',()=> openLightbox(i))
          });
        })();
      </script>

      <footer class="zone foot bottom-section"><ul class="foot-nav"></ul></footer>
    </div>
  </div>

  <!-- Preferred title/subtitle + chip CSS -->
  <style>
    /* NAV container & title stack safety */
    .zone.nav-bar{ overflow: visible !important; height: auto !important; }

    .title-stack{
      display:flex; flex-direction:column; align-items:center; justify-content:flex-start;
      gap:0; margin:0; padding:0; max-width:100%; overflow:visible !important;
    }
    .dg-title, .dg-subtitle, .title-stack .container, .title-stack .zone{
      display:block !important; position:static !important; float:none !important; clear:both !important;
      margin:0 !important; padding:0 !important; height:auto !important; max-height:none !important; min-height:0 !important;
      overflow:visible !important; white-space:normal; word-break:normal; overflow-wrap:normal; text-align:center;
    }
    .dg-title{ line-height:1.10; }
    .dg-subtitle{ line-height:1.12; }
    @media (min-width:700px){
      .title-stack{ gap:0 !important; }
      .dg-title{ line-height:1.06 !important; }
      .dg-subtitle{
        line-height:1.06 !important;
        margin-top: clamp(-4px, -0.45vw, -8px) !important; /* pull subtitle closer without overlap */
      }
    }
    @media (max-width:700px){
      .dg-subtitle{ font-size:clamp(.72rem, 2.6vw, .95rem); }
    }
    @media (max-width:400px){
      .dg-subtitle{ font-size:clamp(.62rem, 3.4vw, .88rem); }
    }

    /* ======================= CHIPS: centered, touching, responsive ======================= */
    .navbar{
      display:flex; justify-content:center; align-items:stretch; gap:0 !important;
      height:auto !important; min-height:40px; padding:0; margin:0 auto; width:100%;
      overflow:visible !important;
    }
    .navbar a.nospace{ display:none !important; }  /* hide spacers so chips can touch */

    .navbar a.border,
    .navbar a.active.border{
      position: static !important;
      float: none !important;
      display: inline-flex !important;
      box-sizing: border-box !important;

      /* default sizing: one-line, size to content */
      width: auto !important;
      min-width: 0 !important;
      max-width: none !important;
      white-space: nowrap !important;

      height: auto !important;
      margin: 0 !important;
      overflow: visible !important;
      word-break: normal !important;
      text-overflow: clip !important;
      align-items: center !important;
      justify-content: center !important;

      /* Visuals */
      border: 2px solid green !important;
      border-radius: 0 !important;                /* sharp corners */
      background: transparent !important;
      color: #fff !important;

      /* Readability */
      font-size: clamp(.66rem, 2.4vw, 1rem) !important;
      line-height: 1.05 !important;
      padding: clamp(6px, 1.1vw, 12px) clamp(12px, 2.2vw, 20px) !important;

      /* Keep them from stretching weirdly; seam handled below */
      flex: 0 0 auto !important;
      text-align:center !important;
    }
    .navbar a.active.border{ background-color:#4CAF50 !important; border-color:green !important; }

    /* Touching seam (shared border) */
    .navbar a.border + .navbar a.border{ margin-left:-2px !important; }

    /* Narrower below 700px (meet-in-the-middle) */
    @media (max-width:700px){
      .navbar a.border,
      .navbar a.active.border{
        white-space: normal !important;
        overflow-wrap: anywhere !important;
        line-height: 1.12 !important;
        flex-basis: clamp(150px, 30vw, 230px) !important;
        padding: 6px 10px !important;
      }
    }

    /* Further shorten under 500px so borders don't look too long */
    @media (max-width:500px){
      .navbar a.border,
      .navbar a.active.border{
        flex-basis: clamp(120px, 26vw, 180px) !important;
        padding-left: 8px !important;
        padding-right: 8px !important;
      }
    }

    /* Extra-small phones */
    @media (max-width:420px){
      .navbar a.border,
      .navbar a.active.border{
        font-size: clamp(.58rem, 2vw, .88rem) !important;
        padding: 5px 8px !important;
      }
    }
    @media (max-width:340px){
      .navbar a.border,
      .navbar a.active.border{
        font-size: clamp(.54rem, 2vw, .84rem) !important;
        padding: 4px 8px !important;
      }
    }

    /* Mid-band widening: 700–999 px */
    @media (min-width:700px) and (max-width:999px){
      .navbar a.border,
      .navbar a.active.border{
        flex-basis: clamp(220px, 30vw, 320px) !important;
        padding-left: clamp(16px, 1.8vw, 28px) !important;
        padding-right: clamp(16px, 1.8vw, 28px) !important;
        font-size: clamp(.85rem, 1.2vw, 1.02rem) !important;
      }
    }

    /* Desktop widening: ≥1000px */
    @media (min-width:1000px){
      .navbar a.border,
      .navbar a.active.border{
        flex-basis: clamp(320px, 22vw, 420px) !important;
        padding-left: clamp(22px, 1.4vw, 34px) !important;
        padding-right: clamp(22px, 1.4vw, 34px) !important;
        font-size: clamp(.9rem, 1.05vw, 1.08rem) !important;
      }
    }
  </style>
</body>
</html>
